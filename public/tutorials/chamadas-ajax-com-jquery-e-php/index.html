<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Chamadas Ajax com jQuery e PHP | Henrique Dias</title>
<meta name="description" content="Efetuar pedidos POST e GET utilizando a função ajax do jQuery e responder utilizando a linguagem de servidor PHP.">
<link rel="canonical" href="http://localhost:1313/tutorials/chamadas-ajax-com-jquery-e-php">
<link rel="publisher" href="https://plus.google.com/+HenriqueDias"/>
<meta property="og:locale" content="en-us" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Chamadas Ajax com jQuery e PHP | Henrique Dias" />
<meta property="og:description" content="Efetuar pedidos POST e GET utilizando a função ajax do jQuery e responder utilizando a linguagem de servidor PHP." />
<meta property="og:url" content="http://localhost:1313/tutorials/chamadas-ajax-com-jquery-e-php" />
<meta property="og:site_name" content="Henrique Dias | A CompSci Enthusiast" />
<meta property="article:publisher" content="https://www.facebook.com/hacdias" />
<meta property="article:author" content="https://www.facebook.com/hacdias" />
<meta property="article:tag" content="Ajax, JavaScript, JQuery, PHP" />
<meta property="article:section" content="Tutorials" />
<meta property="article:published_time" content="2014-07-20T10:41:11Z" />
<meta property="article:modified_time" content="2014-07-20T10:41:11Z" />
<meta property="og:updated_time" content="2014-07-20T10:41:11Z" />
<meta property="og:image" content="http://localhost:1313/images/chamadas-ajax-com-jquery-e-php.jpg" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:description" content="Efetuar pedidos POST e GET utilizando a função ajax do jQuery e responder utilizando a linguagem de servidor PHP."/>
<meta name="twitter:title" content="Chamadas Ajax com jQuery e PHP | Henrique Dias"/>
<meta name="twitter:site" content="@hacdias"/>
<meta name="twitter:domain" content="Henrique Dias"/>
<meta name="twitter:image:src" content="http://localhost:1313/images/chamadas-ajax-com-jquery-e-php.jpg"/>
<meta name="twitter:creator" content="@hacdias"/>

<meta name="msvalidate.01" content="B471CBBC9EF6900039C6BBF251EF277C" />
<meta name="google-site-verification" content="nVQ4_x6m6ZTRAzclMPNxpB0iMgK-xoIj_d-l85u32nY" />


<link rel="shortcut icon" href="http://localhost:1313/favicon.ico" type="image/x-icon">
<link rel="icon" href="http://localhost:1313/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="http://localhost:1313/css/normalize.css">
<link rel="stylesheet" href="http://localhost:1313/css/main.css">
<link rel="stylesheet" href="http://localhost:1313/css/syntax.css">
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "email": "mailto:hacdias@gmail.com",
  "image": "http:\/\/localhost:1313\/henrique.png",
  "jobTitle": "Author",
  "name": "Henrique Dias",
  "telephone": "351 965 856 140",
  "url": "http:\/\/localhost:1313\/",
  "sameAs" : [ "http://www.facebook.com/hacdias",
      "http://twitter.com/hacdias",
      "http://instagram.com/hacdias",
      "http://www.linkedin.com/in/hacdias",
      "http://plus.google.com/+HenriqueDias"]
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": "Henrique Dias",
  "name": "Chamadas Ajax com jQuery e PHP"
}
</script>

</head>

<body>

<header class="site-header">
  <div class="left site-title">
    <a href="http://localhost:1313/">Henrique<strong>Dias</strong></a>
  </div><div class="right">
    <nav>
       <ul>
           <li><a href="http://localhost:1313/">Home</a></li>
           <li><a href="http://localhost:1313/about/">About</a></li>
       </ul>
    </nav>
  </div>
</header>


<article>
  <header class="imaged">
    
    <div class="banner" style="background-image: url('http://localhost:1313/images/chamadas-ajax-com-jquery-e-php.jpg')"></div>
    
    <div class="container">
      <h1>Chamadas Ajax com jQuery e PHP</h1>
      <span class="meta">
        Posted on <time datetime="2015-06-23">June 23, 2015
      </span>
    </div>
  </header>

  <div class="container">
    <p>A biblioteca <a href="http://jquery.com/">jQuery</a> é das mais conhecidas e utilizadas em JavaScript. Com esta biblioteca podemos proceder a chamadas <strong>ajax</strong> muito facilmente através de poucas linhas de código.</p>

<p>Vamos aprender a efetuar pedidos POST e GET com Ajax, obtendo os dados do lado do servidor utilizando PHP e responder a essa mesma chamada.</p>

<p>Iremos analisar um exemplo prático: um  formulário de registo ou inscrição  utilizando as tags <code>&lt;form&gt;</code> do HTML, Ajax para enviar os pedidos para o servidor e  PHP processar os dados e enviar a resposta novamente para o lado do cliente onde será mostrada uma mensagem de sucesso ou erro conforme o sucedido.</p>

<p>Como vamos utilizar o método Ajax do jQuery, temos que importar, em primeiro lugar, a biblioteca jQuery. Na secção <head>  do vosso ficheiro onde vai estar o registo - vou chamar-lhe <code>index.html</code> - devem colocar o seguinte código:</p>

<div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</pre></div>


<p>Esse pequeno trecho importa a versão 2.1.1 do jQuery e está armazenada nos servidores da Google e o seu uso é livre e qualquer um pode utilizar. Para criar o formulário de registo, vamos utilizar as tags <code>&lt;form&gt;</code> do HTML, criando assim, algo semelhante ao seguinte:</p>

<div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Formulário de Registo<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">&quot;registo&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">action=</span><span class="s">&quot;javascript:enviarRegisto();&quot;</span><span class="nt">&gt;</span>

	<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">id=</span><span class="s">&quot;nome&quot;</span> <span class="na">name=</span><span class="s">&quot;nome&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Nome&quot;</span><span class="nt">&gt;&lt;br&gt;</span>
	<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;password&quot;</span> <span class="na">id=</span><span class="s">&quot;password&quot;</span> <span class="na">name=</span><span class="s">&quot;password&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Password&quot;</span><span class="nt">&gt;&lt;br&gt;</span>
	<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;email&quot;</span> <span class="na">id=</span><span class="s">&quot;email&quot;</span> <span class="na">name=</span><span class="s">&quot;email&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Email&quot;</span><span class="nt">&gt;&lt;br&gt;</span>
	<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submeter&quot;</span><span class="nt">&gt;</span>

<span class="nt">&lt;/form&gt;</span>
</pre></div>


<p>O título não é necessário para o  pleno funcionamento do formulário. Como podem ver, todos os <inputs>  estão identificados com um id. No final encontra-se um botão para submeter o formulário. Este botão direciona para a ação do formulário que, neste caso, é javascript:enviarRegisto(); .</p>

<p>O método (method) não é necessário visto que este vai ser definido diretamente através do pedido em Ajax. Agora vamos à parte do servidor - registar o utilizador. Vamos criar um ficheiro com o nome <code>processar.php</code> o mesmo local onde temos o nosso <code>index.html</code>. Neste ficheiro teremos o código seguinte ou semelhante:</p>

<div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="cm">/*</span>
<span class="cm"> * Receber os dados do formulário através</span>
<span class="cm"> * de informações enviadas pelo ajax com</span>
<span class="cm"> * o método POST.</span>
<span class="cm"> */</span>
<span class="nv">$nome</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nome&#39;</span><span class="p">];</span>
<span class="nv">$password</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">];</span>
<span class="nv">$email</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">];</span>

<span class="cm">/*</span>
<span class="cm"> * Criação de uma variável que mais tarde irá</span>
<span class="cm"> * guardar o resultado da operação: se foi concluída</span>
<span class="cm"> * com sucesso ou não.</span>
<span class="cm"> */</span>
<span class="nv">$resultado</span> <span class="o">=</span>  <span class="k">array</span><span class="p">();</span>

<span class="cm">/*</span>
<span class="cm"> * Ligação à base de dados utilizando PDO. Eu, por exemplo,</span>
<span class="cm"> * utilizei SQLite mas  pode ser utilizado qualquer outro tipo</span>
<span class="cm"> * de bases de dado.</span>
<span class="cm"> */</span>
<span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">PDO</span><span class="p">(</span><span class="s1">&#39;sqlite:db.sqlite&#39;</span><span class="p">);</span>


<span class="cm">/*</span>
<span class="cm"> * Query/Chamada para inserir os dados que obtemos via POST</span>
<span class="cm"> * na base de dados.</span>
<span class="cm"> */</span>
<span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO utilizadores VALUES (&#39;&quot;</span> <span class="o">.</span> <span class="nv">$nome</span> <span class="o">.</span> <span class="s2">&quot;&#39;, &#39;&quot;</span> <span class="o">.</span> <span class="nv">$password</span> <span class="o">.</span> <span class="s2">&quot;&#39;, &#39;&quot;</span> <span class="o">.</span> <span class="nv">$email</span> <span class="o">.</span> <span class="s2">&quot;&#39;);&quot;</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nv">$db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$query</span><span class="p">))</span> <span class="p">{</span>

	<span class="cm">/*</span>
<span class="cm">	 * Se a chamada for concluída com  sucesso,</span>
<span class="cm">	 * será atribuído o valor &quot;true&quot; ao elemento</span>
<span class="cm">	 * status da array $resultado.</span>
<span class="cm">	 */</span>

	<span class="nv">$resultado</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>

<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

	<span class="c1">//Caso contrário será falso.</span>

	<span class="nv">$resultado</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/*</span>
<span class="cm"> * Informa que o arquivo vai ser do tipo Json.</span>
<span class="cm"> * Assim, o Ajax vai conseguir receber a resposta</span>
<span class="cm"> * corretamente.</span>
<span class="cm"> */</span>

<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-type: application/json&#39;</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Envio da array $resultado novamente para o lado do cliente</span>
<span class="cm"> * em  formato json.</span>
<span class="cm"> */</span>
<span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">);</span>

<span class="cp">?&gt;</span><span class="x"></span>
</pre></div>


<p>Podes ler mais sobre o formato <strong>json</strong> <a href="http://json.org/">aqui</a>. Antes de continuarmos, vamos estabelecer as diferenças entre os métodos POST e GET. Talvez a maior diferença entre estes dois métodos seja a visibilidade. O método <strong>GET</strong> leva a informação &ldquo;agarrada&rdquo; ao URL e qualquer pessoa pode ver. Os URLs com informações anexadas são do seguinte formato:</p>

<p><code>http://example.com?infoNome=info&amp;infoNome2=info2</code></p>

<p>Por outro lado, o método <strong>POST </strong>leva a informação encapsulada no corpo do pedido e não pode visualizada. Uma desvantagem deste método é ser mais lento visto que é encapsulado ao contrário do GET, que é mais simples. Como os pedidos GET são feitos através do URL, existe uma limitação no comprimento da mensagem enviada sendo que não pode ter mais de 255 caracteres dependendo do browser.</p>

<p>O <strong>tipo de dados</strong> é outra grande diferença: enquanto que o método GET só pode enviar texto, o método POST pode enviar qualquer tipo de informação. Podes saber mais sobre estes dois métodos <a href="http://www.w3schools.com/tags/ref_httpmethods.asp">aqui</a>. Agora que já temos o formulário de registo e o servidor preparado, só falta fazer a ligação entre o cliente e o servidor utilizando Ajax.</p>

<p>Em primeiro lugar, criamos um novo ficheiro chamado, por exemplo, <code>script.js</code> e chamomo-lo logo a seguir ao jQuery no nosso <code>index.html</code> com um código semelhante ao seguinte:Agora, dentro do ficheiro de javascript, vamos ter que criar a função que anteriormente colocámos na ação do formulário, a função enviarRegisto().</p>

<div class="highlight"><pre><span class="kd">function</span> <span class="nx">enviarRegisto</span><span class="p">()</span> <span class="p">{</span>

    <span class="cm">/*</span>
<span class="cm">     * Obtenção dos dados do formulário e colocação dos mesmos</span>
<span class="cm">     * no formato nomeDaInfo=Info para enviar por POST.</span>
<span class="cm">     *</span>
<span class="cm">     * Utiliza-se a função val() para obter os valores</span>
<span class="cm">     * dos inputs com os id&#39;s em questão.</span>
<span class="cm">     */</span>


    <span class="cm">/*</span>
<span class="cm">     * Criação da variável data que vai conter toda a informação</span>
<span class="cm">     * a enviar para o servidor.</span>
<span class="cm">     */</span>
    <span class="nx">data</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#registo&quot;</span><span class="p">).</span><span class="nx">serialize</span><span class="p">();</span>

    <span class="cm">/*</span>
<span class="cm">     * Podemos também definir a variável data da seguinte forma:</span>
<span class="cm">     *</span>
<span class="cm">     * nome = &#39;nome=&#39; + $(&#39;#nome&#39;).val();</span>
<span class="cm">     * password = &#39;password=&#39; + $(&#39;#password&#39;).val();</span>
<span class="cm">     * email = &#39;email=&#39; + $(&#39;#email&#39;).val();</span>
<span class="cm">     *</span>
<span class="cm">     * data = nome + &#39;&amp;&#39; + password + &#39;&amp;&#39; + email;</span>
<span class="cm">     */</span>

    <span class="c1">//Começa aqui o pedido ajax</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="c1">//Tipo do pedido que, neste caso, é POST</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
        <span class="cm">/*</span>
<span class="cm">         * URL do ficheiro que para o qual iremos enviar os dados.</span>
<span class="cm">         * Pode ser um url absoluto ou relativo.</span>
<span class="cm">         */</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;processar.php&#39;</span><span class="p">,</span>
        <span class="c1">//Que dados vamos enviar? A variável &quot;data&quot;</span>
        <span class="nx">data</span><span class="o">:</span> <span class="nx">data</span><span class="p">,</span>
        <span class="c1">//O tipo da informação da resposta</span>
        <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span>
    <span class="p">}).</span><span class="nx">done</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>

        <span class="cm">/*</span>
<span class="cm">         * Quando a chamada Ajax é terminada com sucesso,</span>
<span class="cm">         * o javascript confirma o status da operação</span>
<span class="cm">         * com a variável que enviámos no formato json.</span>
<span class="cm">         */</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">//Se for positivo, mostra ao utilizador uma janela de sucesso.</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Registo bem Sucedido!&#39;</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="c1">//Caso contrário dizemos que aconteceu algum erro.</span>
            <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Uups! Ocorreu algum erro!&#39;</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">}).</span><span class="nx">fail</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">desc</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
        <span class="cm">/*</span>
<span class="cm">         * Caso haja algum erro na chamada Ajax,</span>
<span class="cm">         * o utilizador é alertado e serão enviados detalhes</span>
<span class="cm">         * para a consola javascript que pode ser visualizada</span>
<span class="cm">         * através das ferramentas de desenvolvedor do browser.</span>
<span class="cm">         */</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;Uups! Ocorreu algum erro!&#39;</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">xhr</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Detalhes: &quot;</span> <span class="o">+</span> <span class="nx">desc</span> <span class="o">+</span> <span class="s2">&quot;nErro:&quot;</span> <span class="o">+</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>


<p>Relembro que todo o código neste artigo é para fins demonstrativos e que para fins profissionais devem ser aplicadas medidas de segurança de forma a que terceiros não consigam obter os dados que estão a ser transmitidos.</p>

<p>Depois de guardar o ficheiro, podemos abrir o formulário, preenchê-lo, enviá-lo e ver se tudo foi bem sucedido.</p>

<p>Qualquer dúvida que tenham procurado e não tenham conseguido resolver, não hesitem em perguntar mas nunca se esqueçam: antes de <strong>perguntar</strong>, devem <strong>procurar</strong> e <strong>tentar </strong>porque só assim é que vão realmente compreender a 100% :)</p>

<p><a href="/downloads/post-get-ajax-resposta-php.zip">Download</a> | <a href="/downloads/post-get-ajax-resposta-php-comentado.zip">Download (Comentado)</a></p>

  </div>

  <footer class="container">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'hacdias';
    var disqus_identifier = 'http:\/\/localhost:1313\/tutorials\/chamadas-ajax-com-jquery-e-php';
    var disqus_title = 'Chamadas Ajax com jQuery e PHP';
    var disqus_url = 'http:\/\/localhost:1313\/tutorials\/chamadas-ajax-com-jquery-e-php';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </footer>
</article>

<footer>
About | Projects | Publications | Contact
</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59697241-1', 'auto');
  ga('send', 'pageview');
</script>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

