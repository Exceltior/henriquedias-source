<!DOCTYPE html>
<html class="no-js" lang="en-US">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>PHP - Como utilizar o Gettext para traduções [Parte 1] | Henrique Dias</title>
<meta name="description" content="A linguagem PHP está repleta de extensões. Uma muito utilizada e útil é o Gettext que nos permite traduzir um site muito facilmente.">
<link rel="canonical" href="http://localhost:1313/tutorials/php-como-utilizar-o-gettext-para-traducoes">
<link rel="publisher" href="https://plus.google.com/+HenriqueDias"/>
<meta property="og:locale" content="en-us" />
<meta property="og:type" content="article" />
<meta property="og:title" content="PHP - Como utilizar o Gettext para traduções [Parte 1] | Henrique Dias" />
<meta property="og:description" content="A linguagem PHP está repleta de extensões. Uma muito utilizada e útil é o Gettext que nos permite traduzir um site muito facilmente." />
<meta property="og:url" content="http://localhost:1313/tutorials/php-como-utilizar-o-gettext-para-traducoes" />
<meta property="og:site_name" content="Henrique Dias | A CompSci Enthusiast" />
<meta property="article:publisher" content="https://www.facebook.com/hacdias" />
<meta property="article:author" content="https://www.facebook.com/hacdias" />
<meta property="article:tag" content="Gettext, PHP, Tutorial" />
<meta property="article:section" content="Tutorials" />
<meta property="article:published_time" content="2014-09-21T11:07:03Z" />
<meta property="article:modified_time" content="2014-09-21T11:07:03Z" />
<meta property="og:updated_time" content="2014-09-21T11:07:03Z" />
<meta property="og:image" content="http://localhost:1313/images/gettext.jpg" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:description" content="A linguagem PHP está repleta de extensões. Uma muito utilizada e útil é o Gettext que nos permite traduzir um site muito facilmente."/>
<meta name="twitter:title" content="PHP - Como utilizar o Gettext para traduções [Parte 1] | Henrique Dias"/>
<meta name="twitter:site" content="@hacdias"/>
<meta name="twitter:domain" content="Henrique Dias"/>
<meta name="twitter:image:src" content="http://localhost:1313/images/gettext.jpg"/>
<meta name="twitter:creator" content="@hacdias"/>

<meta name="msvalidate.01" content="B471CBBC9EF6900039C6BBF251EF277C" />
<meta name="google-site-verification" content="nVQ4_x6m6ZTRAzclMPNxpB0iMgK-xoIj_d-l85u32nY" />


<link rel="shortcut icon" href="http://localhost:1313/favicon.ico" type="image/x-icon">
<link rel="icon" href="http://localhost:1313/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="http://localhost:1313/css/normalize.css">
<link rel="stylesheet" href="http://localhost:1313/css/main.css">
<link rel="stylesheet" href="http://localhost:1313/css/syntax.css">
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "email": "mailto:hacdias@gmail.com",
  "image": "http:\/\/localhost:1313\/henrique.png",
  "jobTitle": "Author",
  "name": "Henrique Dias",
  "telephone": "351 965 856 140",
  "url": "http:\/\/localhost:1313\/",
  "sameAs" : [ "http://www.facebook.com/hacdias",
      "http://twitter.com/hacdias",
      "http://instagram.com/hacdias",
      "http://www.linkedin.com/in/hacdias",
      "http://plus.google.com/+HenriqueDias"]
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": "Henrique Dias",
  "name": "PHP - Como utilizar o Gettext para traduções [Parte 1]"
}
</script>

</head>

<body lang="en">


<section id="main">
  <h1 id="title">PHP - Como utilizar o Gettext para traduções [Parte 1]</h1>
  <div>
        <article id="content">
           

<p>Como prometido no <a href="/explanations/php-wordpress-comandos-printf-sprintf/">último artigo</a>, hoje irá começar uma pequena saga de dois ou três artigos sobre como utilizar o Gettext no PHP.</p>

<p>Com o <strong>gettext</strong> podemos ter um site disponível em diversas linguagens de forma muito fácil e sem complicações. Nesta primeira parte, irá ser abordado como <strong>configurar o gettext</strong> e as suas <strong>funções</strong>.</p>

<p>O gettext pode ser configurado no PHP através de uma extensão nativa ou através do uso de uma biblioteca separada.Nós iremos utilizar o segundo método por ser mais simples e fácil de configurar.</p>

<h2 id="download-e-estruturação:f7cadadb33380485931edab1f79d8ea6">Download e estruturação</h2>

<p>Antes de mais nada, aviso que é <strong>necessário</strong> ter a extensão <em>mbstring</em> ativada nas definições do PHP. Em primeiro lugar, deve fazer o <em>download</em> do <strong>php-gettext</strong> nesta <a href="https://launchpad.net/php-gettext/">página</a>.</p>

<p>Depois de efetuar o <em>download</em>, irá ter que descompactar o ficheiro transferido. Após a sua descompactação irá encontrar diversos ficheiros. Apenas iremos precisar dos seguintes:</p>

<ul>
<li><code>gettext.inc</code> → Aliases de funções para utilizar no sistema;</li>
<li><code>gettext.php</code> → Funções do gettext;</li>
<li><code>streams.php</code> → Classes e métodos que permitem ler ficheiros do gettext.</li>
</ul>

<p>Agora crie uma pasta cujo conteúdo seja semelhante ao seguinte:</p>

<div class="highlight"><pre>site-multi-lingua/
  <span class="p">|</span> lib /
  <span class="p">|</span>     <span class="p">|</span> gettext.inc
  <span class="p">|</span>     <span class="p">|</span> gettext.php
  <span class="p">|</span>      streams.php
  <span class="p">|</span>
  <span class="p">|</span> langs/
  <span class="p">|</span>
  <span class="p">|</span>
  <span class="p">|</span> config.php
  <span class="p">|</span> i18n.php
   index.php
</pre></div>


<p>Como pode visualizar, os ficheiros do gettext foram colocados dentro de uma pasta chamada `<code>lib</code> e ainda foram adicionados três outros ficheiros:</p>

<ul>
<li><code>config.php</code> → faz o carregamento das configurações;</li>
<li><code>i18n.php</code> → contém a inicialização do gettext;</li>
<li><code>index.php</code></li>
</ul>

<p>Inicialmente tem que ser definida uma linguagem padrão. Nós iremos utilizar &ldquo;pt_PT&rdquo; ou seja, Português de Portugal.</p>

<p>Para isso, edite o seu ficheiro _config.php _e coloque o seguinte:</p>

<div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="nb">define</span><span class="p">(</span><span class="s1">&#39;LANG&#39;</span><span class="p">,</span><span class="s1">&#39;pt_PT&#39;</span><span class="p">);</span>
</pre></div>


<h2 id="inicialização-do-gettext:f7cadadb33380485931edab1f79d8ea6">Inicialização do Gettext</h2>

<p>Agora que já existe uma linguagem padrão definida, a inicialização do gettext deve ser feita porém, primeiro tem que memorizar os seguintes conceitos:</p>

<ul>
<li><p><code>locale</code> → uma <em>string</em> no formato <code>xx_XX</code> que indica a linguagem. &ldquo;pt<em>BR&rdquo; é português do Brasil, &ldquo;en_US&rdquo; corresponde a Inglês dos Estados Unidos. Pode ler mais sobre estes prefixos [aqui](<a href="http://pt.wikipedia.org/wiki/Internacionaliza%C3%A7%C3%A3o">http://pt.wikipedia.org/wiki/Internacionaliza%C3%A7%C3%A3o</a></em>(software)).</p></li>

<li><p><code>textdomain</code> → quer dizer &ldquo;domínio de texto&rdquo; e é um local onde as traduções vão ser colocadas. No nosso caso, apenas iremos utilizar um <em>textdomain</em>.</p></li>
</ul>

<p>Agora, deve colocar no ficheiro <strong>i18n.php </strong>o seguinte conteúdo:</p>

<div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;config.php&#39;</span><span class="p">);</span>

<span class="nv">$locale</span> <span class="o">=</span> <span class="nx">LANG</span><span class="p">;</span>
<span class="nv">$textdomain</span> <span class="o">=</span> <span class="s2">&quot;site_multi_lingua&quot;</span><span class="p">;</span>
<span class="nv">$locales_dir</span> <span class="o">=</span> <span class="nb">dirname</span><span class="p">(</span><span class="k">__FILE__</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;/lang&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">]))</span>
  <span class="nv">$locale</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;lang&#39;</span><span class="p">];</span>

<span class="nb">putenv</span><span class="p">(</span><span class="s1">&#39;LANGUAGE=&#39;</span> <span class="o">.</span> <span class="nv">$locale</span><span class="p">);</span>
<span class="nb">putenv</span><span class="p">(</span><span class="s1">&#39;LANG=&#39;</span> <span class="o">.</span> <span class="nv">$locale</span><span class="p">);</span>
<span class="nb">putenv</span><span class="p">(</span><span class="s1">&#39;LC_ALL=&#39;</span> <span class="o">.</span> <span class="nv">$locale</span><span class="p">);</span>
<span class="nb">putenv</span><span class="p">(</span><span class="s1">&#39;LC_MESSAGES=&#39;</span> <span class="o">.</span> <span class="nv">$locale</span><span class="p">);</span>

<span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;lib/gettext.inc&#39;</span><span class="p">);</span>

<span class="nx">_setlocale</span><span class="p">(</span><span class="nx">LC_ALL</span><span class="p">,</span> <span class="nv">$locale</span><span class="p">);</span>
<span class="nx">_setlocale</span><span class="p">(</span><span class="nx">LC_CTYPE</span><span class="p">,</span> <span class="nv">$locale</span><span class="p">);</span>

<span class="nx">_bindtextdomain</span><span class="p">(</span><span class="nv">$textdomain</span><span class="p">,</span> <span class="nv">$locales_dir</span><span class="p">);</span>
<span class="nx">_bind_textdomain_codeset</span><span class="p">(</span><span class="nv">$textdomain</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">);</span>
<span class="nx">_textdomain</span><span class="p">(</span><span class="nv">$textdomain</span><span class="p">);</span>

<span class="k">function</span> <span class="nf">_e</span><span class="p">(</span><span class="nv">$string</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">echo</span> <span class="nx">__</span><span class="p">(</span><span class="nv">$string</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>Poça! Tanta coisa! Mas para que serve tudo isto? Na <strong>linha 3</strong>, o ficheiro <code>config.php</code> é chamado pois é este que contém a constante da linguagem. Assim podemos já podemos utilizar essa constante neste ficheiro.</p>

<p>Nas linhas seguintes (<strong>5 a 7</strong>), a variável <code>$locale</code> é definida, tal como o domínio de texto e o local onde irão estar os ficheiros de tradução que, neste caso, será numa pasta chamada lang .</p>

<p>Mais à frente, nas <strong>linhas 8 a 9</strong>, verificamos se existe uma variável chamada <code>lang</code> a ser passada pelo URL. Se sim, reescrevemos o valor da variável <code>$locale</code> com essa linguagem.</p>

<p>Nas linhas seguintes, <strong>12 a 5</strong>, as variáveis de ambiente do sistema operativo são alteradas para o locale  que está a ser utilizado.</p>

<p>Na linha cuja posição é <strong>17</strong>, a biblioteca php-gettext é carregada sendo logo a seguir (<strong>19 a 20</strong>), o locale também carregado para o gettext.</p>

<p>Seguidamente, <strong>nas linhas 22 a 24</strong>, o textdomain é defido, tal como a codificação que será utilizada nesses ficheiros (UTF-8) e ainda dizemos onde vão estar as traduções.</p>

<p>De seguida é criada uma função chamada <code>_e()</code> que nos permite imprimir o resultado da função <code>__()</code>.</p>

<p>Agora, copiem e colem o seguinte no <code>index.php</code>:</p>

<div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;i18n.php&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html&gt;</span>
<span class="x">  &lt;head&gt;</span>
<span class="x">    &lt;meta charset=&quot;UTF-8&quot; /&gt;</span>
<span class="x">    &lt;title&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">__</span><span class="p">(</span><span class="s1">&#39;Olá Mundo!&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/title&gt;</span>
<span class="x">  &lt;/head&gt;</span>
<span class="x">  &lt;body&gt;</span>
<span class="x">    &lt;h1&gt;</span><span class="cp">&lt;?php</span> <span class="nx">_e</span><span class="p">(</span><span class="s1">&#39;Olá Mundo!&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/h1&gt;</span>
<span class="x">  &lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</pre></div>


<p>De momento, ainda não existe nada de extraordinário a acontecer. Na próxima parte deste tutorial iremos falar em como criar as traduções!</p>

        </article>
  </div>
</section>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'hacdias';
    var disqus_identifier = 'http:\/\/localhost:1313\/tutorials\/php-como-utilizar-o-gettext-para-traducoes';
    var disqus_title = 'PHP - Como utilizar o Gettext para traduções [Parte 1]';
    var disqus_url = 'http:\/\/localhost:1313\/tutorials\/php-como-utilizar-o-gettext-para-traducoes';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<footer>

</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59697241-1', 'auto');
  ga('send', 'pageview');
</script>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

