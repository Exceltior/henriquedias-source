<!DOCTYPE html>
<html class="no-js" lang="en-US">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>WordPress: adicionar menus de administração [Parte 2] | Henrique Dias</title>
<meta name="description" content="Esta é a continuação do tutorial sobre como adicionar menus de administração a temas e plugins do WordPress.">
<link rel="canonical" href="http://localhost:1313/tutorials/wordpress-adicionar-menus-de-administracao-parte-2">
<link rel="publisher" href="https://plus.google.com/+HenriqueDias"/>
<meta property="og:locale" content="en-us" />
<meta property="og:type" content="article" />
<meta property="og:title" content="WordPress: adicionar menus de administração [Parte 2] | Henrique Dias" />
<meta property="og:description" content="Esta é a continuação do tutorial sobre como adicionar menus de administração a temas e plugins do WordPress." />
<meta property="og:url" content="http://localhost:1313/tutorials/wordpress-adicionar-menus-de-administracao-parte-2" />
<meta property="og:site_name" content="Henrique Dias | A CompSci Enthusiast" />
<meta property="article:publisher" content="https://www.facebook.com/hacdias" />
<meta property="article:author" content="https://www.facebook.com/hacdias" />
<meta property="article:tag" content="Dica, Tutorial, WordPress" />
<meta property="article:section" content="Tutorials" />
<meta property="article:published_time" content="2014-08-04T12:01:37Z" />
<meta property="article:modified_time" content="2015-06-10T11:27:37Z" />
<meta property="og:updated_time" content="2015-06-10T11:27:37Z" />
<meta property="og:image" content="http://localhost:1313/images/criacao-menus.jpg" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:description" content="Esta é a continuação do tutorial sobre como adicionar menus de administração a temas e plugins do WordPress."/>
<meta name="twitter:title" content="WordPress: adicionar menus de administração [Parte 2] | Henrique Dias"/>
<meta name="twitter:site" content="@hacdias"/>
<meta name="twitter:domain" content="Henrique Dias"/>
<meta name="twitter:image:src" content="http://localhost:1313/images/criacao-menus.jpg"/>
<meta name="twitter:creator" content="@hacdias"/>

<meta name="msvalidate.01" content="B471CBBC9EF6900039C6BBF251EF277C" />
<meta name="google-site-verification" content="nVQ4_x6m6ZTRAzclMPNxpB0iMgK-xoIj_d-l85u32nY" />


<link rel="shortcut icon" href="http://localhost:1313/favicon.ico" type="image/x-icon">
<link rel="icon" href="http://localhost:1313/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="http://localhost:1313/css/normalize.css">
<link rel="stylesheet" href="http://localhost:1313/css/main.css">
<link rel="stylesheet" href="http://localhost:1313/css/syntax.css">
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Person",
  "email": "mailto:hacdias@gmail.com",
  "image": "http:\/\/localhost:1313\/henrique.png",
  "jobTitle": "Author",
  "name": "Henrique Dias",
  "telephone": "351 965 856 140",
  "url": "http:\/\/localhost:1313\/",
  "sameAs" : [ "http://www.facebook.com/hacdias",
      "http://twitter.com/hacdias",
      "http://instagram.com/hacdias",
      "http://www.linkedin.com/in/hacdias",
      "http://plus.google.com/+HenriqueDias"]
}
</script>

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": "Henrique Dias",
  "name": "WordPress: adicionar menus de administração [Parte 2]"
}
</script>

</head>

<body lang="en">


<section id="main">
  <h1 id="title">WordPress: adicionar menus de administração [Parte 2]</h1>
  <div>
        <article id="content">
           <p>O <strong>WordPress</strong> é, como vocês sabem, um dos mais populares CMS do mundo. Isto, se não o for. Um dos nossos primeiros artigos foi referente ao WordPress e ensinámos a <a href="/tutorials/remover-hash-dos-links-continuar-a-ler/">remover a hash dos links &ldquo;Ler mais&rdquo;</a>.</p>

<p>Hoje vamos dar continuação ao tutorial sobre como <a href="/tutorials/wordpress-adicionar-menus-de-administracao/">adicionar menus de administração</a> a temas e plugins do WordPress.</p>

<p>Na primeira parte, criámos duas funções e adicionámos uma opção ao menu de administração do WordPress sendo que ficámos com o seguinte código:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="k">function</span> <span class="nf">themeslug_admin_menus</span><span class="p">()</span> <span class="p">{</span>

    <span class="c1">//Adição do sub-menu Opções ao menu principal Apresentação</span>
    <span class="nx">add_theme_page</span><span class="p">(</span><span class="s1">&#39;Opções&#39;</span><span class="p">,</span> <span class="s1">&#39;Opções&#39;</span><span class="p">,</span> <span class="s1">&#39;manage_options&#39;</span><span class="p">,</span> <span class="s1">&#39;opcoes&#39;</span><span class="p">,</span> <span class="s1">&#39;themeslug_options&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">themeslug_options</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//Esta função vai conter a página &quot;Opções&quot;.</span>
<span class="p">}</span>

<span class="nx">add_action</span><span class="p">(</span><span class="s2">&quot;admin_menu&quot;</span><span class="p">,</span> <span class="s2">&quot;themeslug_admin_menus&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>Hoje vamos dedicar-nos, principalmente, à segunda função (<code>themeslug_options()</code>) e à utilização de uma variável definida nas opções.</p>

<p>Resumindo, hoje vamos fazer o seguinte:</p>

<ul>
<li><p>Criar uma opção das definições para adicionar o <em>link</em> do site para a sua página do Facebook.</p></li>

<li><p>Se o <em>link</em> estiver definido, vai aparecer um ícone no tema para ir para a página, caso não esteja, o ícone não aparecerá.</p></li>
</ul>

<p>Pode parecer complicado, mas vai ver que é simples. Vamos começar por substituir o comentário que está dentro da função themeslug_options  pelo seguinte:</p>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?php</span>

<span class="c1">//...</span>

<span class="cm">/*</span>
<span class="cm"> * Este loop if verifica se o utilizador tem permissões suficientes</span>
<span class="cm"> * para aceder a esta página. Se não tiver, a função termina aqui</span>
<span class="cm"> * utilizando a função wp_die() e será apresentada a mensagem que está</span>
<span class="cm"> * dentro de parêntesis ao utilizador.</span>
<span class="cm"> */</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">current_user_can</span><span class="p">(</span><span class="s1">&#39;manage_options&#39;</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">wp_die</span><span class="p">(</span><span class="s1">&#39;Não tem permissões suficientes para aceder a esta página!&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;!--  Aqui começa a nossa página, inserindo o título. --&gt;</span>
<span class="x">&lt;div class=&quot;wrap&quot;&gt;</span>
<span class="x">    &lt;h2&gt;Opções&lt;/h2&gt;</span>

<span class="cp">&lt;?php</span>

<span class="cm">/*</span>
<span class="cm"> * Ao voltarmos ao PHP, declaramos uma variável chamada Facebook que vai</span>
<span class="cm"> * conter a opção que irá ser definida.</span>
<span class="cm"> *</span>
<span class="cm"> * Esta variável vai buscar a opção que está guardada. (Ver &#39;if&#39; seguinte)</span>
<span class="cm"> */</span>

<span class="nv">$facebook</span> <span class="o">=</span> <span class="nx">get_option</span><span class="p">(</span><span class="s2">&quot;themeslug_facebook&quot;</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm"> * Neste loop if, verificamos se o formulário abaixo foi submetido. Isto é feito</span>
<span class="cm"> * verificando se um &quot;input&quot; abaixo foi definido. Este estará oculto de forma a</span>
<span class="cm"> * que não possa ser alterado.</span>
<span class="cm"> *</span>
<span class="cm"> * Se estiver definida, a variável $facebook será &quot;reescrita&quot; colocando desta</span>
<span class="cm"> * vez o valor obtido através do método POST do formulário a seguir.</span>
<span class="cm"> */</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&quot;update_settings&quot;</span><span class="p">]))</span> <span class="p">{</span>

    <span class="nv">$facebook</span> <span class="o">=</span> <span class="nx">esc_attr</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s2">&quot;facebook&quot;</span><span class="p">]);</span>

    <span class="cm">/*</span>
<span class="cm">     * Aqui atualizamos a opção &quot;themeslug_facebook&quot; com o valor da variável</span>
<span class="cm">     * $facebook.</span>
<span class="cm">     */</span>
    <span class="nx">update_option</span><span class="p">(</span><span class="s2">&quot;themeslug_facebook&quot;</span><span class="p">,</span> <span class="nv">$facebook</span><span class="p">);</span>

    <span class="c1">//Apresentação de uma mensagem de sucesso</span>
    <span class="cp">?&gt;</span><span class="x"> &lt;div id=&quot;message&quot; class=&quot;updated below-h2&quot;&gt;&lt;p&gt;Definições guardadas&lt;/p&gt;&lt;/div&gt; </span><span class="cp">&lt;?php</span>

<span class="p">}</span>

<span class="cm">/* Formulário que utilizaremos para submeter as definições.</span>
<span class="cm"> * Este formulário utiliza classes CSS próprias do WordPress,</span>
<span class="cm"> * como &quot;top&quot; e outras.  </span>
<span class="cm"> */</span>

<span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;form method=&quot;POST&quot; action=&quot;&quot;&gt;</span>
<span class="x">    &lt;table class=&quot;form-table&quot;&gt;</span>
<span class="x">        &lt;tr valign=&quot;top&quot;&gt;</span>
<span class="x">            &lt;th scope=&quot;row&quot;&gt;</span>
<span class="x">                &lt;label for=&quot;facebook&quot;&gt;</span>
<span class="x">                    Facebook:</span>
<span class="x">                &lt;/label&gt;</span>
<span class="x">            &lt;/th&gt;</span>
<span class="x">            &lt;td&gt;</span>
<span class="x">                </span><span class="cp">&lt;?php</span> <span class="cm">/* Este input será onde colocaremos o link. O seu valor será igual à variável $facebook</span>
<span class="cm">                    anteriormente definida. Assim, caso essa opção não tenha sido definida, será apresentado</span>
<span class="cm">                    um campo vazio.</span>

<span class="cm">                    Caso já tenha sido definida, o campo irá conter o valor atual tornando-se mais fácil de editar. */</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">                &lt;input type=&quot;text&quot; name=&quot;facebook&quot; size=&quot;100%&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$facebook</span><span class="p">;</span><span class="cp">?&gt;</span><span class="x">&quot;/&gt;</span>
<span class="x">            &lt;/td&gt;</span>
<span class="x">        &lt;/tr&gt;</span>
<span class="x">    &lt;/table&gt;</span>

<span class="x">    </span><span class="cp">&lt;?php</span> <span class="cm">/* Criação de um input oculto para informar o PHP se estamos a submeter o formulário ou não. */</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;input type=&quot;hidden&quot; name=&quot;update_settings&quot; value=&quot;Y&quot; /&gt;</span>

<span class="x">    </span><span class="cp">&lt;?php</span> <span class="cm">/* Botão de submissão do formulário. */</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Guardar alterações&quot; class=&quot;button button-primary&quot; /&gt;</span>
<span class="x">&lt;/form&gt;    </span><span class="cp">&lt;?php</span>
</pre></div>
</td></tr></table>

<p>O código acima está integralmente comentado. Se lerem os comentários de cima para baixo, não conhecendo o resto do código, é normal que sintam alguma confusão.</p>

<p>Porém, essa ordem é necessária de forma a que a variável <code>$facebook</code> fique definida e apareça no input  do formulário. Por isso, se tiverem alguma dúvida, não hesitem em perguntar.</p>

<p>Agora, quando acederem às definições do vosso tema (neste caso), irão ter uma página de opções.</p>

<p>Podem agora definir o <em>link</em> para a página do Facebook que desejam utilizar. Depois de guardarem as alterações ir-vos-à ser apresentada uma mensagem.</p>

<p>Para aplicar a variável no tema é muito simples. Como viram acima, utilizámos a função get_option  para obter a opção que foi gravada e será assim que a iremos obter e utilizar no tema.</p>

<p>O código acima verifica se a opção <code>themeslug_facebook</code> foi definida e se sim, cria um link em HTML que direcionará para a página que foi definida nas opções do tema.</p>

<p>É simples utilizar as opções nos temas do WordPress. Não se esqueçam, se não compreenderem qualquer coisa, podem sempre utilizar os comentários ou utilizar a <a href="/contact">página de contacto</a>.</p>

<p>Espero que tenham gostado deste pequeno tutorial :)</p>

        </article>
  </div>
</section>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'hacdias';
    var disqus_identifier = 'http:\/\/localhost:1313\/tutorials\/wordpress-adicionar-menus-de-administracao-parte-2';
    var disqus_title = 'WordPress: adicionar menus de administração [Parte 2]';
    var disqus_url = 'http:\/\/localhost:1313\/tutorials\/wordpress-adicionar-menus-de-administracao-parte-2';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<footer>

</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59697241-1', 'auto');
  ga('send', 'pageview');
</script>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

