<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Gettext on Henrique Dias</title>
    <link>http://localhost:1313/tags/gettext/</link>
    <description>Recent content in Gettext on Henrique Dias</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 21 Sep 2014 11:07:03 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/gettext/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>PHP - Como utilizar o Gettext para traduções [Parte 1]</title>
      <link>http://localhost:1313/tutorials/php-como-utilizar-o-gettext-para-traducoes</link>
      <pubDate>Sun, 21 Sep 2014 11:07:03 +0000</pubDate>
      
      <guid>http://localhost:1313/tutorials/php-como-utilizar-o-gettext-para-traducoes</guid>
      <description>

&lt;p&gt;Como prometido no &lt;a href=&#34;http://localhost:1313/explanations/php-wordpress-comandos-printf-sprintf/&#34;&gt;último artigo&lt;/a&gt;, hoje irá começar uma pequena saga de dois ou três artigos sobre como utilizar o Gettext no PHP.&lt;/p&gt;

&lt;p&gt;Com o &lt;strong&gt;gettext&lt;/strong&gt; podemos ter um site disponível em diversas linguagens de forma muito fácil e sem complicações. Nesta primeira parte, irá ser abordado como &lt;strong&gt;configurar o gettext&lt;/strong&gt; e as suas &lt;strong&gt;funções&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;O gettext pode ser configurado no PHP através de uma extensão nativa ou através do uso de uma biblioteca separada.Nós iremos utilizar o segundo método por ser mais simples e fácil de configurar.&lt;/p&gt;

&lt;h2 id=&#34;download-e-estruturação:f7cadadb33380485931edab1f79d8ea6&#34;&gt;Download e estruturação&lt;/h2&gt;

&lt;p&gt;Antes de mais nada, aviso que é &lt;strong&gt;necessário&lt;/strong&gt; ter a extensão &lt;em&gt;mbstring&lt;/em&gt; ativada nas definições do PHP. Em primeiro lugar, deve fazer o &lt;em&gt;download&lt;/em&gt; do &lt;strong&gt;php-gettext&lt;/strong&gt; nesta &lt;a href=&#34;https://launchpad.net/php-gettext/&#34;&gt;página&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Depois de efetuar o &lt;em&gt;download&lt;/em&gt;, irá ter que descompactar o ficheiro transferido. Após a sua descompactação irá encontrar diversos ficheiros. Apenas iremos precisar dos seguintes:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;gettext.inc&lt;/code&gt; → Aliases de funções para utilizar no sistema;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;gettext.php&lt;/code&gt; → Funções do gettext;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;streams.php&lt;/code&gt; → Classes e métodos que permitem ler ficheiros do gettext.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Agora crie uma pasta cujo conteúdo seja semelhante ao seguinte:&lt;/p&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;site-multi-lingua/
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; lib /
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; gettext.inc
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; gettext.php
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;      streams.php
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; langs/
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; config.php
  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; i18n.php
   index.php
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Como pode visualizar, os ficheiros do gettext foram colocados dentro de uma pasta chamada `&lt;code&gt;lib&lt;/code&gt; e ainda foram adicionados três outros ficheiros:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;config.php&lt;/code&gt; → faz o carregamento das configurações;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;i18n.php&lt;/code&gt; → contém a inicialização do gettext;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;index.php&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Inicialmente tem que ser definida uma linguagem padrão. Nós iremos utilizar &amp;ldquo;pt_PT&amp;rdquo; ou seja, Português de Portugal.&lt;/p&gt;

&lt;p&gt;Para isso, edite o seu ficheiro _config.php _e coloque o seguinte:&lt;/p&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;define&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LANG&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;pt_PT&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h2 id=&#34;inicialização-do-gettext:f7cadadb33380485931edab1f79d8ea6&#34;&gt;Inicialização do Gettext&lt;/h2&gt;

&lt;p&gt;Agora que já existe uma linguagem padrão definida, a inicialização do gettext deve ser feita porém, primeiro tem que memorizar os seguintes conceitos:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;locale&lt;/code&gt; → uma &lt;em&gt;string&lt;/em&gt; no formato &lt;code&gt;xx_XX&lt;/code&gt; que indica a linguagem. &amp;ldquo;pt&lt;em&gt;BR&amp;rdquo; é português do Brasil, &amp;ldquo;en_US&amp;rdquo; corresponde a Inglês dos Estados Unidos. Pode ler mais sobre estes prefixos [aqui](&lt;a href=&#34;http://pt.wikipedia.org/wiki/Internacionaliza%C3%A7%C3%A3o&#34;&gt;http://pt.wikipedia.org/wiki/Internacionaliza%C3%A7%C3%A3o&lt;/a&gt;&lt;/em&gt;(software)).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;textdomain&lt;/code&gt; → quer dizer &amp;ldquo;domínio de texto&amp;rdquo; e é um local onde as traduções vão ser colocadas. No nosso caso, apenas iremos utilizar um &lt;em&gt;textdomain&lt;/em&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Agora, deve colocar no ficheiro &lt;strong&gt;i18n.php &lt;/strong&gt;o seguinte conteúdo:&lt;/p&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;config.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;LANG&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$textdomain&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;site_multi_lingua&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;span class=&#34;nv&#34;&gt;$locales_dir&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;dirname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;__FILE__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;/lang&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;isset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lang&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;empty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lang&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
  &lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$_GET&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lang&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;

&lt;span class=&#34;nb&#34;&gt;putenv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LANGUAGE=&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;putenv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LANG=&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;putenv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LC_ALL=&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;putenv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;LC_MESSAGES=&amp;#39;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;lib/gettext.inc&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;_setlocale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;LC_ALL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;_setlocale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;LC_CTYPE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$locale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;nx&#34;&gt;_bindtextdomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$textdomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;$locales_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;_bind_textdomain_codeset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$textdomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;_textdomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$textdomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;_e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Poça! Tanta coisa! Mas para que serve tudo isto? Na &lt;strong&gt;linha 3&lt;/strong&gt;, o ficheiro &lt;code&gt;config.php&lt;/code&gt; é chamado pois é este que contém a constante da linguagem. Assim podemos já podemos utilizar essa constante neste ficheiro.&lt;/p&gt;

&lt;p&gt;Nas linhas seguintes (&lt;strong&gt;5 a 7&lt;/strong&gt;), a variável &lt;code&gt;$locale&lt;/code&gt; é definida, tal como o domínio de texto e o local onde irão estar os ficheiros de tradução que, neste caso, será numa pasta chamada lang .&lt;/p&gt;

&lt;p&gt;Mais à frente, nas &lt;strong&gt;linhas 8 a 9&lt;/strong&gt;, verificamos se existe uma variável chamada &lt;code&gt;lang&lt;/code&gt; a ser passada pelo URL. Se sim, reescrevemos o valor da variável &lt;code&gt;$locale&lt;/code&gt; com essa linguagem.&lt;/p&gt;

&lt;p&gt;Nas linhas seguintes, &lt;strong&gt;12 a 5&lt;/strong&gt;, as variáveis de ambiente do sistema operativo são alteradas para o locale  que está a ser utilizado.&lt;/p&gt;

&lt;p&gt;Na linha cuja posição é &lt;strong&gt;17&lt;/strong&gt;, a biblioteca php-gettext é carregada sendo logo a seguir (&lt;strong&gt;19 a 20&lt;/strong&gt;), o locale também carregado para o gettext.&lt;/p&gt;

&lt;p&gt;Seguidamente, &lt;strong&gt;nas linhas 22 a 24&lt;/strong&gt;, o textdomain é defido, tal como a codificação que será utilizada nesses ficheiros (UTF-8) e ainda dizemos onde vão estar as traduções.&lt;/p&gt;

&lt;p&gt;De seguida é criada uma função chamada &lt;code&gt;_e()&lt;/code&gt; que nos permite imprimir o resultado da função &lt;code&gt;__()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Agora, copiem e colem o seguinte no &lt;code&gt;index.php&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&#34;highlight&#34;&gt;&lt;pre&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class=&#34;k&#34;&gt;require_once&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;i18n.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&lt;/span&gt;

&lt;span class=&#34;x&#34;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;  &amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot; /&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    &amp;lt;title&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Olá Mundo!&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;  &amp;lt;/head&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;  &amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;    &amp;lt;h1&amp;gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Olá Mundo!&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;x&#34;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;  &amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&#34;x&#34;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;De momento, ainda não existe nada de extraordinário a acontecer. Na próxima parte deste tutorial iremos falar em como criar as traduções!&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
